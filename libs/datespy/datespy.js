/**
 * DateSpy.JS 0.1, 2013/10/01
 * @author Ferron Hanse
 * (c) 2013 https://github.com/ferronrsmith/datespy
 * License: MIT
 */
var datespy={};!function(global){function addTimer(a,b){if(0===a.length)throw new Error("Function requires at least 1 parameter");var c=id++,d=a[1]||0;return this.timeouts||(this.timeouts={}),this.timeouts[c]={id:c,func:a[0],callAt:this.now+d,invokeArgs:Array.prototype.slice.call(a,2)},b===!0&&(this.timeouts[c].interval=d),c}function parseTime(a){if(!a)return 0;var b,c=a.split(":"),d=c.length,e=d,f=0;if(d>3||!/^(\d\d:){0,2}\d\d?$/.test(a))throw new Error("tick only understands numbers and 'h:m:s'");for(;e--;){if(b=parseInt(c[e],10),b>=60)throw new Error("Invalid time "+a);f+=b*Math.pow(60,d-e-1)}return 1e3*f}function createObject(a){var b,c;return Object.create?b=Object.create(a):(c=function(){},c.prototype=a,b=new c),b.Date.clock=b,b}function mirrorDateProperties(a,b){return b.now?a.now=function(){return a.clock.now}:delete a.now,b.toSource?a.toSource=function(){return b.toSource()}:delete a.toSource,a.toString=function(){return b.toString()},a.prototype=b.prototype,a.parse=b.parse,a.UTC=b.UTC,a.prototype.toUTCString=b.prototype.toUTCString,a}function restore(){var a,b,c;for(b=0,c=this.methods.length;c>b;b++)a=this.methods[b],global[a].hadOwnProperty?global[a]=this["_"+a]:delete global[a];this.methods=[]}function stubGlobal(a,b){var c,d;if(b[a].hadOwnProperty=Object.prototype.hasOwnProperty.call(global,a),b["_"+a]=global[a],"Date"===a)c=mirrorDateProperties(b[a],global[a]),global[a]=c;else{global[a]=function(){return b[a].apply(b,arguments)};for(d in b[a])b[a].hasOwnProperty(d)&&(global[a][d]=b[a][d])}global[a].clock=b}var id=1,methods=[];datespy.clock={now:0,create:function(a){var b=createObject(this);if("number"==typeof a&&(b.now=a),a&&"object"==typeof a)throw new TypeError("now should be milliseconds since UNIX epoch");return b},setTimeout:function(){return addTimer.call(this,arguments,!1)},clearTimeout:function(a){this.timeouts||(this.timeouts=[]),this.timeouts.hasOwnProperty(a)&&delete this.timeouts[a]},setInterval:function(){return addTimer.call(this,arguments,!0)},clearInterval:function(a){this.clearTimeout(a)},tick:function(a){a="number"==typeof a?a:parseTime(a);for(var b,c=this.now,d=this.now+a,e=this.now,f=this.firstTimerInRange(c,d);f&&d>=c;){if(this.timeouts[f.id]){c=this.now=f.callAt;try{this.callTimer(f)}catch(g){b=b||g}}f=this.firstTimerInRange(e,d),e=c}if(this.now=d,b)throw b;return this.now},firstTimerInRange:function(a,b){var c,d,e;for(e in this.timeouts)this.timeouts.hasOwnProperty(e)&&(this.timeouts[e].callAt<a||this.timeouts[e].callAt>b||(!d||this.timeouts[e].callAt<d)&&(d=this.timeouts[e].callAt,c={func:this.timeouts[e].func,callAt:this.timeouts[e].callAt,interval:this.timeouts[e].interval,id:this.timeouts[e].id,invokeArgs:this.timeouts[e].invokeArgs}));return c||null},callTimer:function(timer){var exception;"number"==typeof timer.interval?this.timeouts[timer.id].callAt+=timer.interval:delete this.timeouts[timer.id];try{"function"==typeof timer.func?timer.func.apply(null,timer.invokeArgs):eval(timer.func)}catch(e){exception=e}if(this.timeouts[timer.id]){if(exception)throw exception}else if(exception)throw exception},reset:function(){this.timeouts={}},Date:function(){function a(c,d,e,f,g,h,i){switch(arguments.length){case 0:return new b(a.clock.now);case 1:return new b(c);case 2:return new b(c,d);case 3:return new b(c,d,e);case 4:return new b(c,d,e,f);case 5:return new b(c,d,e,f,g);case 6:return new b(c,d,e,f,g,h);default:return new b(c,d,e,f,g,h,i)}}var b=Date;return mirrorDateProperties(a,b)}()},methods=["Date","setTimeout","setInterval","clearTimeout","clearInterval"],datespy.useFakeTimers=function(a){var b,c,d=datespy.clock.create(a);for(d.restore=restore,d.$restoreDate=restore,d.methods=Array.prototype.slice.call(arguments,"number"==typeof a?1:0),0===d.methods.length&&(d.methods=methods),b=0,c=d.methods.length;c>b;b++)stubGlobal(d.methods[b],d);return d}}("object"==typeof global&&"function"!=typeof global?global:this),datespy.timers={setTimeout:setTimeout,clearTimeout:clearTimeout,setInterval:setInterval,clearInterval:clearInterval,Date:Date},/MSIE ([0-9]{1,}[\.0-9]{0,})/.test(navigator.userAgent)&&!function(){"use strict";function a(){}function b(){}function c(){}function d(){}function e(){}a=datespy.timers.setTimeout,b=datespy.timers.clearTimeout,c=datespy.timers.setInterval,d=datespy.timers.clearInterval,e=datespy.timers.Date}(),void 0!==window.angular&&void 0!==angular.mock&&angular.extend(angular.mock,{$mockDate:function(){return datespy.useFakeTimers.apply(null,arguments)}});